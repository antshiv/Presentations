<svg id="b00a9b77-3646-4264-b2ab-5601f43891cb" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1500 504.7"><defs><linearGradient id="ffb502f4-7a93-43a6-acb8-f89603b2b1dc" x1="248.77" y1="-248.81" x2="1251.23" y2="753.51" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#0a0a0a"/><stop offset="1" stop-color="#1a1a2e"/></linearGradient><linearGradient id="a6962ff7-4df7-430a-a944-b4ad326030a5" x1="-412.77" y1="-338.93" x2="-411.77" y2="-338.93" gradientTransform="translate(33072 10323) scale(80 30)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#3498db"/><stop offset="1" stop-color="#2980b9"/></linearGradient><linearGradient id="e87f3ae6-84dd-4c6a-8c1d-fde0bd9fb83f" x1="-412.77" y1="-338.93" x2="-411.77" y2="-338.93" gradientTransform="translate(33182 10383) scale(80 30)" xlink:href="#a6962ff7-4df7-430a-a944-b4ad326030a5"/><linearGradient id="adf20954-a65f-4702-8c4d-50f070a27c18" x1="-412.77" y1="-338.93" x2="-411.77" y2="-338.93" gradientTransform="translate(33302 10323) scale(80 30)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#9b59b6"/><stop offset="1" stop-color="#8e44ad"/></linearGradient><linearGradient id="a5b4e0e5-c7d2-4144-9e69-a28fd23ff7a0" x1="-412.77" y1="-338.93" x2="-411.77" y2="-338.93" gradientTransform="translate(33422 10383) scale(80 30)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#e74c3c"/><stop offset="1" stop-color="#c0392b"/></linearGradient><linearGradient id="b4d0fb8a-aa7f-4163-8fdd-388faf918df1" x1="-412.77" y1="-338.93" x2="-411.77" y2="-338.93" gradientTransform="translate(33542 10323) scale(80 30)" xlink:href="#a6962ff7-4df7-430a-a944-b4ad326030a5"/><linearGradient id="b935af7c-a560-480f-8026-480107357428" x1="-412.77" y1="-338.93" x2="-411.77" y2="-338.93" gradientTransform="translate(33662 10383) scale(80 30)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#f39c12"/><stop offset="1" stop-color="#e67e22"/></linearGradient><pattern id="e3ccaf04-cb62-4788-a207-5e07129013fb" data-name="SVGID 0000004198962464737954979" width="10" height="10" patternTransform="translate(18 17792.14)" patternUnits="userSpaceOnUse" viewBox="0 0 10 10"><rect width="10" height="10" style="fill:none"/><rect width="10" height="10" style="fill:none"/><rect width="10" height="10" style="fill:#2ed573"/><path d="M0,0H10M0,5H10M0,10H10" style="stroke:#26de81"/></pattern></defs><rect width="1500" height="504.7" style="fill:url(#ffb502f4-7a93-43a6-acb8-f89603b2b1dc)"/><text transform="translate(295.64 40)" style="isolation:isolate;font-size:28px;fill:#fff;font-family:Arial-BoldMT, Arial;font-weight:700">Intra-Layer Cache Dependencies: Every Intermediate Output Matters</text><text transform="translate(440.7 65)" style="isolation:isolate;font-size:16px;fill:#f39c12;font-family:ArialMT, Arial">LayerNorm → QKV →<tspan x="158.26" y="0" style="letter-spacing:-0.05517578125em"> </tspan><tspan x="161.82" y="0">Attention → LayerNorm → MLP:</tspan><tspan x="391.23" y="0" style="letter-spacing:-0.01806640625em"> </tspan><tspan x="395.39" y="0">The Complete Data Flow Chain</tspan></text><g id="a1b2c93e-b7a1-47cc-a1f3-e0c62c42a8ae" data-name="separated"><rect x="114.2" y="92.8" width="521.6" height="24.7" style="fill:none"/><text transform="translate(114.2 110)" style="isolation:isolate;font-size:20px;fill:#e74c3c;font-family:Arial-BoldMT, Arial;font-weight:700"><tspan style="letter-spacing:-0.05517578125em">T</tspan><tspan x="11.11" y="0">raditional: Separated</tspan><tspan x="210.05" y="0" style="letter-spacing:-0.037109375em"> </tspan><tspan x="214.86" y="0">Activation Buffers (Cache </tspan></text><rect x="77.8" y="151.4" width="24.4" height="12.3" style="fill:none"/><rect x="76.9" y="174.1" width="26.2" height="9.5" style="fill:none"/><path d="M54,140h72a4,4,0,0,1,4,4v22a4,4,0,0,1-4,4H54a4,4,0,0,1-4-4V144A4,4,0,0,1,54,140Z" style="fill:url(#a6962ff7-4df7-430a-a944-b4ad326030a5)"/><text transform="translate(77.78 160)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:Arial-BoldMT, Arial;font-weight:700">Input</text><text transform="translate(76.88 181)" style="isolation:isolate;font-size:8px;fill:#95a5a6;font-family:ArialMT, Arial">0x1000</text><rect x="180.6" y="211.4" width="38.9" height="12.3" style="fill:none"/><rect x="186.9" y="234.1" width="26.2" height="9.5" style="fill:none"/><path d="M164,200h72a4,4,0,0,1,4,4v22a4,4,0,0,1-4,4H164a4,4,0,0,1-4-4V204A4,4,0,0,1,164,200Z" style="fill:url(#e87f3ae6-84dd-4c6a-8c1d-fde0bd9fb83f)"/><text transform="translate(180.56 220)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:Arial-BoldMT, Arial;font-weight:700">LN1 Out</text><text transform="translate(186.88 241)" style="isolation:isolate;font-size:8px;fill:#95a5a6;font-family:ArialMT, Arial">0x5000</text><rect x="299.2" y="151.4" width="41.7" height="12.3" style="fill:none"/><rect x="306.9" y="174.1" width="26.2" height="9.5" style="fill:none"/><path d="M284,140h72a4,4,0,0,1,4,4v22a4,4,0,0,1-4,4H284a4,4,0,0,1-4-4V144A4,4,0,0,1,284,140Z" style="fill:url(#adf20954-a65f-4702-8c4d-50f070a27c18)"/><text transform="translate(299.17 160)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:Arial-BoldMT, Arial;font-weight:700">QKV Out</text><text transform="translate(306.88 181)" style="isolation:isolate;font-size:8px;fill:#95a5a6;font-family:ArialMT, Arial">0x8000</text><rect x="420" y="211.4" width="40" height="12.3" style="fill:none"/><rect x="426.2" y="234.1" width="27.6" height="9.5" style="fill:none"/><path d="M404,200h72a4,4,0,0,1,4,4v22a4,4,0,0,1-4,4H404a4,4,0,0,1-4-4V204A4,4,0,0,1,404,200Z" style="fill:url(#a5b4e0e5-c7d2-4144-9e69-a28fd23ff7a0)"/><text transform="translate(420.01 220)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:Arial-BoldMT, Arial;font-weight:700">Attn Out</text><text transform="translate(426.21 241)" style="isolation:isolate;font-size:8px;fill:#95a5a6;font-family:ArialMT, Arial">0xC000</text><rect x="540.6" y="151.4" width="38.9" height="12.3" style="fill:none"/><rect x="546.7" y="174.1" width="26.7" height="9.5" style="fill:none"/><path d="M524,140h72a4,4,0,0,1,4,4v22a4,4,0,0,1-4,4H524a4,4,0,0,1-4-4V144A4,4,0,0,1,524,140Z" style="fill:url(#b4d0fb8a-aa7f-4163-8fdd-388faf918df1)"/><text transform="translate(540.56 160)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:Arial-BoldMT, Arial;font-weight:700">LN2 Out</text><text transform="translate(546.66 181)" style="isolation:isolate;font-size:8px;fill:#95a5a6;font-family:ArialMT, Arial">0xF000</text><rect x="659.5" y="211.4" width="40.9" height="12.3" style="fill:none"/><rect x="664.7" y="234.1" width="30.7" height="9.5" style="fill:none"/><path d="M644,200h72a4,4,0,0,1,4,4v22a4,4,0,0,1-4,4H644a4,4,0,0,1-4-4V204A4,4,0,0,1,644,200Z" style="fill:url(#b935af7c-a560-480f-8026-480107357428)"/><text transform="translate(669.07 220)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:Arial-BoldMT, Arial;font-weight:700">ML<tspan x="14.44" y="0" style="letter-spacing:-0.01806640625em">P</tspan><tspan x="20.93" y="0"> </tspan></text><text transform="translate(664.65 241)" style="isolation:isolate;font-size:8px;fill:#95a5a6;font-family:ArialMT, Arial">0x12000</text><rect x="209.4" y="249.7" width="331.2" height="14.8" style="fill:none"/><text transform="translate(209.41 260)" style="isolation:isolate;font-size:12px;fill:#ff4757;font-family:Arial-BoldMT, Arial;font-weight:700">Every arrow = Cache miss! Data scattered across memory</text><path d="M58,280H692a8,8,0,0,1,8,8V472a8,8,0,0,1-8,8H58a8,8,0,0,1-8-8V288A8,8,0,0,1,58,280Z" style="fill:#2c2c54;stroke:#e74c3c;stroke-width:2px"/><rect x="60" y="291.3" width="290.8" height="19.8" style="fill:none"/><g style="isolation:isolate"><text transform="translate(60 305)" style="isolation:isolate;font-size:16px;fill:#e74c3c;font-family:Arial-BoldMT, Arial;font-weight:700">Execution <tspan x="80.91" y="0" style="letter-spacing:-0.05517578125em">T</tspan><tspan x="89.8" y="0">race: Cache Miss Cascade</tspan></text></g><rect x="70" y="313.8" width="127.8" height="16" style="fill:none"/><text transform="translate(70 325)" style="isolation:isolate;font-size:13px;fill:#3498db;font-family:Arial-BoldMT, Arial;font-weight:700">1. LayerNorm(input):</text><rect x="80" y="329.7" width="277" height="14.2" style="fill:none"/><text transform="translate(80 340)" style="isolation:isolate;font-size:12px;fill:#fff;font-family:ArialMT, Arial">• Read input from 0x1000 → Cache loads input data</text><rect x="80" y="344.7" width="300.6" height="14.2" style="fill:none"/><text transform="translate(80 355)" style="isolation:isolate;font-size:12px;fill:#fff;font-family:ArialMT, Arial">• <tspan x="7.54" y="0" style="letter-spacing:-0.01806640625em">W</tspan><tspan x="18.64" y="0">rite LN1 output to 0x5000 → Di</tspan><tspan x="183.4" y="0" style="letter-spacing:-0.01806640625em">f</tspan><tspan x="186.52" y="0">ferent memory </tspan></text><rect x="70" y="363.8" width="127.8" height="16" style="fill:none"/><text transform="translate(70 375)" style="isolation:isolate;font-size:13px;fill:#9b59b6;font-family:Arial-BoldMT, Arial;font-weight:700">2. QKV(LN1_output):</text><rect x="80" y="379.7" width="336.3" height="14.2" style="fill:none"/><text transform="translate(80 390)" style="isolation:isolate;font-size:12px;fill:#ff4757;font-family:ArialMT, Arial">• Read LN1 output from 0x5000 → CACHE MISS! (evicts input)</text><rect x="80" y="394.7" width="307.9" height="14.2" style="fill:none"/><g style="isolation:isolate"><text transform="translate(80 405)" style="isolation:isolate;font-size:12px;fill:#fff;font-family:ArialMT, Arial">• <tspan x="7.54" y="0" style="letter-spacing:-0.01806640625em">W</tspan><tspan x="18.64" y="0">rite QKV output to 0x8000 →</tspan><tspan x="172.07" y="0" style="letter-spacing:-0.05517578125em"> </tspan><tspan x="174.74" y="0">Another di</tspan><tspan x="229.44" y="0" style="letter-spacing:-0.01806640625em">f</tspan><tspan x="232.56" y="0">ferent loca</tspan></text><text transform="translate(369.7 405)" style="isolation:isolate;font-size:12px;fill:#fff;font-family:ArialMT, Arial">-</text></g><rect x="70" y="413.8" width="159.8" height="16" style="fill:none"/><g style="isolation:isolate"><text transform="translate(70 425)" style="isolation:isolate;font-size:13px;fill:#e74c3c;font-family:Arial-BoldMT, Arial;font-weight:700">3.<tspan x="10.84" y="0" style="letter-spacing:-0.037109375em"> </tspan><tspan x="13.97" y="0">Attention(QKV_out</tspan></text><text transform="translate(201.4 425)" style="isolation:isolate;font-size:13px;fill:#e74c3c;font-family:Arial-BoldMT, Arial;font-weight:700">-</text></g><rect x="80" y="429.7" width="325.7" height="14.2" style="fill:none"/><text transform="translate(80 440)" style="isolation:isolate;font-size:12px;fill:#ff4757;font-family:ArialMT, Arial">• Read QKV from 0x8000 → CACHE MISS! (evicts LN1 data)</text><rect x="80" y="444.7" width="266.8" height="14.2" style="fill:none"/><g style="isolation:isolate"><text transform="translate(80 455)" style="isolation:isolate;font-size:12px;fill:#fff;font-family:ArialMT, Arial">• <tspan x="7.54" y="0" style="letter-spacing:-0.01806640625em">W</tspan><tspan x="18.64" y="0">rite attention to 0xC000 →</tspan><tspan x="158.06" y="0" style="letter-spacing:-0.01806640625em"> </tspan><tspan x="161.17" y="0" style="letter-spacing:-0.091796875em">Y</tspan><tspan x="168.08" y="0">et another loca</tspan></text><text transform="translate(329 455)" style="isolation:isolate;font-size:12px;fill:#fff;font-family:ArialMT, Arial">-</text></g><rect x="70" y="459.7" width="346.8" height="14.8" style="fill:none"/><text transform="translate(70 470)" style="isolation:isolate;font-size:12px;fill:#ff4757;font-family:Arial-BoldMT, Arial;font-weight:700">Result: 60-80% cache miss rate on EVE<tspan x="224.1" y="0" style="letter-spacing:-0.037109375em">R</tspan><tspan x="232.32" y="0" style="letter-spacing:-0.01806640625em">Y</tspan><tspan x="240.11" y="0" xml:space="preserve"> intermediate </tspan></text><line x1="133.4" y1="170" x2="150" y2="186.6" style="fill:none;stroke:#ff4757;stroke-miterlimit:10;stroke-width:2px"/><polygon points="160 196.6 140.2 188.3 149.3 185.9 151.7 176.8 160 196.6" style="fill:#ff4757"/><line x1="245.1" y1="194.4" x2="261.7" y2="177.8" style="fill:none;stroke:#ff4757;stroke-miterlimit:10;stroke-width:2px"/><polygon points="271.7 167.8 263.4 187.6 261 178.5 251.9 176.1 271.7 167.8" style="fill:#ff4757"/><line x1="370.8" y1="170" x2="387.5" y2="186.6" style="fill:none;stroke:#ff4757;stroke-miterlimit:10;stroke-width:2px"/><polygon points="397.5 196.6 377.7 188.3 386.7 185.9 389.2 176.8 397.5 196.6" style="fill:#ff4757"/><line x1="608.1" y1="170" x2="624.8" y2="186.6" style="fill:none;stroke:#ff4757;stroke-miterlimit:10;stroke-width:2px"/><polygon points="634.8 196.6 614.9 188.3 624 185.9 626.4 176.8 634.8 196.6" style="fill:#ff4757"/><line x1="482.5" y1="194.4" x2="499.2" y2="177.8" style="fill:none;stroke:#ff4757;stroke-miterlimit:10;stroke-width:2px"/><polygon points="509.2 167.8 500.8 187.6 498.4 178.5 489.3 176.1 509.2 167.8" style="fill:#ff4757"/></g><g id="ac9fc892-754b-40c0-8aa6-297b90226a3d" data-name="optmized"><text transform="translate(876.06 110)" style="isolation:isolate;font-size:20px;fill:#2ed573;font-family:Arial-BoldMT, Arial;font-weight:700">Optimized: Unified Memory Layout (Cache Paradise)</text><path d="M806,140h638a6,6,0,0,1,6,6v28a6,6,0,0,1-6,6H806a6,6,0,0,1-6-6V146A6,6,0,0,1,806,140Z" style="stroke:#2ed573;stroke-width:3px;fill:url(#e3ccaf04-cb62-4788-a207-5e07129013fb)"/><text transform="translate(825 135)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">Input</text><text transform="translate(875 135)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">LN1</text><text transform="translate(925 135)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">QKV</text><text transform="translate(975 135)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">Attn</text><text transform="translate(1025 135)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">LN2</text><text transform="translate(1075 135)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">ML<tspan x="12.5" y="0" style="letter-spacing:-0.01806640625em">P</tspan></text><text transform="translate(1125 135)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">Resid</text><text transform="translate(1175 135)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">Output</text><text transform="translate(825 195)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">0x1000</text><text transform="translate(875 195)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">+64B</text><text transform="translate(925 195)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">+128B</text><text transform="translate(975 195)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">+256B</text><text transform="translate(1025 195)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">+384B</text><text transform="translate(1075 195)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">+448B</text><text transform="translate(1125 195)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">+576B</text><text transform="translate(1175 195)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:ArialMT, Arial">+640B</text><text transform="translate(909.14 230)" style="isolation:isolate;font-size:14px;fill:#2ed573;font-family:Arial-BoldMT, Arial;font-weight:700">Perfect Sequential Flow: Every Output → Next Input (Zero Gaps!)</text><path d="M808,280h634a8,8,0,0,1,8,8V472a8,8,0,0,1-8,8H808a8,8,0,0,1-8-8V288A8,8,0,0,1,808,280Z" style="fill:#2c2c54;stroke:#2ed573;stroke-width:2px"/><text transform="translate(810 305)" style="isolation:isolate;font-size:16px;fill:#2ed573;font-family:Arial-BoldMT, Arial;font-weight:700">Execution <tspan x="80.91" y="0" style="letter-spacing:-0.05517578125em">T</tspan><tspan x="89.8" y="0">race: Perfect Cache Flow</tspan></text><text transform="translate(820 325)" style="isolation:isolate;font-size:13px;fill:#3498db;font-family:Arial-BoldMT, Arial;font-weight:700">1. LayerNorm(input):</text><text transform="translate(830 340)" style="isolation:isolate;font-size:12px;fill:#fff;font-family:ArialMT, Arial">• Read input from o<tspan x="102.92" y="0" style="letter-spacing:-0.01806640625em">f</tspan><tspan x="106.04" y="0">fset 0 → Cache loads 64-byte line</tspan></text><text transform="translate(830 355)" style="isolation:isolate;font-size:12px;fill:#26de81;font-family:ArialMT, Arial">• <tspan x="7.54" y="0" style="letter-spacing:-0.01806640625em">W</tspan><tspan x="18.64" y="0">rite LN1 output to o</tspan><tspan x="120.71" y="0" style="letter-spacing:-0.01806640625em">f</tspan><tspan x="123.83" y="0">fset+64B → Next sequential location!</tspan></text><text transform="translate(820 375)" style="isolation:isolate;font-size:13px;fill:#9b59b6;font-family:Arial-BoldMT, Arial;font-weight:700">2. QKV(LN1_output):</text><text transform="translate(830 390)" style="isolation:isolate;font-size:12px;fill:#26de81;font-family:ArialMT, Arial">• Read LN1 from o<tspan x="98.91" y="0" style="letter-spacing:-0.01806640625em">f</tspan><tspan x="102.03" y="0">fset+64B → CACHE HIT! (already loaded)</tspan></text><text transform="translate(830 405)" style="isolation:isolate;font-size:12px;fill:#26de81;font-family:ArialMT, Arial">• <tspan x="7.54" y="0" style="letter-spacing:-0.01806640625em">W</tspan><tspan x="18.64" y="0">rite QKV to o</tspan><tspan x="87.34" y="0" style="letter-spacing:-0.01806640625em">f</tspan><tspan x="90.46" y="0">fset+128B → Sequential, prefetcher ready</tspan></text><text transform="translate(820 425)" style="isolation:isolate;font-size:13px;fill:#e74c3c;font-family:Arial-BoldMT, Arial;font-weight:700">3.<tspan x="10.84" y="0" style="letter-spacing:-0.037109375em"> </tspan><tspan x="13.97" y="0">Attention(QKV_output):</tspan></text><text transform="translate(830 440)" style="isolation:isolate;font-size:12px;fill:#26de81;font-family:ArialMT, Arial">• Read QKV from o<tspan x="102.24" y="0" style="letter-spacing:-0.01806640625em">f</tspan><tspan x="105.36" y="0">fset+128B → CACHE HIT! (prefetched)</tspan></text><text transform="translate(830 455)" style="isolation:isolate;font-size:12px;fill:#26de81;font-family:ArialMT, Arial">• <tspan x="7.54" y="0" style="letter-spacing:-0.01806640625em">W</tspan><tspan x="18.64" y="0">rite attention to o</tspan><tspan x="108.04" y="0" style="letter-spacing:-0.01806640625em">f</tspan><tspan x="111.15" y="0">fset+256B → Continues perfect flow</tspan></text><text transform="translate(820 470)" style="isolation:isolate;font-size:12px;fill:#2ed573;font-family:Arial-BoldMT, Arial;font-weight:700">Result: 95%+ cache hit rate - data flows like a perfect pipeline!</text><line x1="800" y1="210" x2="1431" y2="210" style="fill:none;stroke:#2ed573;stroke-miterlimit:10;stroke-width:4px"/><path d="M1455.2,210c-11.4,4.2-25.5,11.4-34.2,19l6.9-19-6.9-19C1429.7,198.6,1443.8,205.8,1455.2,210Z" style="fill:#2ed573"/></g></svg>