<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Design Guide: RF Soil Sensor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .info-card {
            background-color: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            border: 1px solid #e5e7eb;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 md:p-8 max-w-5xl">
        <!-- Header -->
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-slate-900">Electromagnetic Soil Sensor: A Comprehensive Design Guide</h1>
            <p class="mt-2 text-lg text-red-600 font-semibold">Critical Design Issues & Solutions</p>
        </header>

        <main class="flex flex-col gap-10">

            <!-- 1. CRITICAL: Ground Plane Required -->
            <section class="info-card border-red-500 border-2">
                <h2 class="text-2xl font-bold text-red-600 mb-4">1. CRITICAL: Ground Plane Required</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                    <div>
                        <h3 class="font-bold text-red-700 mb-2">WITHOUT Ground Plane (Wrong)</h3>
                        <svg viewBox="0 0 300 200" class="w-full h-auto border rounded">
                            <rect x="140" y="20" width="20" height="150" fill="#95a5a6"/>
                            <g stroke="#e74c3c" stroke-width="2" fill="none" opacity="0.6">
                                <ellipse cx="150" cy="95" rx="100" ry="30"/>
                                <ellipse cx="150" cy="95" rx="130" ry="45"/>
                            </g>
                        </svg>
                        <ul class="list-disc list-inside mt-2 text-sm text-red-700">
                            <li>Energy radiates sideways & upwards</li>
                            <li>Poor soil penetration</li>
                            <li>Potential FCC violations</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-bold text-green-700 mb-2">WITH Ground Plane (Correct)</h3>
                        <svg viewBox="0 0 300 200" class="w-full h-auto border rounded">
                            <ellipse cx="150" cy="20" rx="80" ry="15" fill="#f39c12" stroke="#d68910"/>
                            <rect x="140" y="20" width="20" height="150" fill="#95a5a6"/>
                            <path d="M 110 35 L 70 170 L 230 170 L 190 35 Z" stroke="#27ae60" stroke-width="2" fill="#27ae60" fill-opacity="0.1"/>
                        </svg>
                        <ul class="list-disc list-inside mt-2 text-sm text-green-800">
                            <li>Energy is directed downward into soil</li>
                            <li>Maximum signal penetration</li>
                            <li>Minimal RF interference</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- 2. What the Spiral Actually Does -->
            <section class="info-card">
                <h2 class="text-2xl font-bold text-slate-900 mb-4">2. What the Spiral Actually Does</h2>
                <div class="flex flex-col md:flex-row items-center gap-8">
                    <div class="w-full md:w-1/2">
                         <h3 class="font-bold text-center mb-2">Cross-Section View</h3>
                        <svg viewBox="0 0 200 200" class="w-full max-w-xs mx-auto h-auto">
                           <circle cx="100" cy="100" r="80" fill="#ecf0f1" stroke="#95a5a6" stroke-width="3"/>
                            <g fill="#f39c12" stroke="#d68910" stroke-width="1">
                                <circle cx="100" cy="25" r="8"/><circle cx="175" cy="100" r="8"/><circle cx="100" cy="175" r="8"/><circle cx="25" cy="100" r="8"/>
                            </g>
                           <circle cx="100" cy="100" r="5" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
                           <g stroke="#3498db" stroke-width="1.5" fill="none" stroke-dasharray="3,3">
                                <line x1="100" y1="100" x2="100" y2="33"/><line x1="100" y1="100" x2="167" y2="100"/><line x1="100" y1="100" x2="100" y2="167"/><line x1="100" y1="100" x2="33" y2="100"/>
                           </g>
                        </svg>
                    </div>
                    <div class="w-full md:w-1/2">
                        <h3 class="font-bold text-lg">It's a "Leaky" Coaxial Transmission Line</h3>
                        <p class="text-slate-700 mt-2">This is NOT a waveguide or a simple antenna. It's a specialized transmission line where the soil itself becomes a core part of the circuit.</p>
                        <ul class="list-disc list-inside mt-2 text-sm space-y-1">
                            <li>The <b class="text-red-600">center rod</b> is the signal conductor.</li>
                            <li>The <b class="text-yellow-600">outer conductor</b> (braid/spiral) is the ground return path.</li>
                            <li>The <b class="text-blue-600">electric field</b> is forced to "leak" through the gaps in the outer conductor and travel through the soil.</li>
                            <li>The soil acts as the **dielectric material**, and its properties (moisture, salinity) directly change the impedance of the line.</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- 3. Environmental Hazards -->
            <section class="info-card border-amber-500 border-2">
                <h2 class="text-2xl font-bold text-amber-600 mb-4">3. Environmental & Material Hazards</h2>
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-bold text-red-700">Problem: Copper Leaching</h3>
                        <p class="text-sm mt-2">Using bare copper for the outer conductor is a significant environmental risk, especially in acidic soils (e.g., peat bogs).</p>
                        <ul class="list-disc list-inside text-sm mt-2 space-y-1 text-red-800">
                            <li>Acidic water can dissolve copper into toxic Cu²⁺ ions.</li>
                            <li>High copper concentrations are toxic to microorganisms, creating a "dead zone" around the probe.</li>
                            <li>Violates environmental regulations for long-term deployments.</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-green-700">Solution: Use Inert Materials</h3>
                        <p class="text-sm mt-2">Select materials that are strong, conductive, and corrosion-resistant for long-term stability and environmental safety.</p>
                        <ul class="list-disc list-inside text-sm mt-2 space-y-1 text-green-800">
                            <li><b>316 Stainless Steel:</b> Excellent choice for both center and outer conductors. Corrosion-resistant and non-toxic.</li>
                             <li><b>Fiberglass/Carbon Fiber Shaft:</b> Far superior to PVC. Won't warp, flex, or crack with temperature and moisture cycles.</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- 4. Complete Electrical Schematic -->
            <section class="info-card">
                 <h2 class="text-2xl font-bold text-slate-900 mb-4">4. Complete Electrical Schematic</h2>
                 <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                         <svg viewBox="-10 0 500 200" class="w-full h-auto">
                            <g>
                                <rect x="0" y="50" width="80" height="50" fill="#e0f2fe" stroke="#0ea5e9" rx="4"/>
                                <text x="40" y="80" text-anchor="middle" font-size="12">Si5351</text>
                                <path d="M 80 75 H 120" stroke="black" stroke-width="2"/>
                                <rect x="120" y="25" width="160" height="100" fill="none" stroke="gray" stroke-dasharray="4 4" rx="4"/>
                                <text x="200" y="18" text-anchor="middle" font-size="10" fill="gray">Directional Bridge</text>
                                <path d="M 120 75 L 150 75 L 150 50 L 180 50" fill="none" stroke="black"/>
                                <rect x="180" y="45" width="40" height="10" fill="white" stroke="black"/> <text x="200" y="40" text-anchor="middle" font-size="10">50Ω</text>
                                <path d="M 220 50 L 250 50 L 250 75 L 280 75" fill="none" stroke="black"/>
                                <path d="M 150 75 L 150 100 L 180 100" fill="none" stroke="black"/>
                                <rect x="180" y="95" width="40" height="10" fill="white" stroke="black"/> <text x="200" y="115" text-anchor="middle" font-size="10">50Ω</text>
                                <path d="M 220 100 L 250 100 L 250 75" fill="none" stroke="black"/>
                                <text x="200" y="80" text-anchor="middle" font-size="10">GND</text>
                                <path d="M 280 75 H 320" stroke="black" stroke-width="2"/>
                                <rect x="320" y="50" width="80" height="50" fill="#f1f5f9" stroke="#94a3b8" rx="4"/>
                                <text x="360" y="80" text-anchor="middle" font-size="12">Probe</text>
                                <path d="M 195 25 V 0" stroke="#e74c3c" stroke-width="2"/>
                                <text x="195" y="-5" text-anchor="middle" font-size="10" fill="#e74c3c">FWD</text>
                                <path d="M 225 125 V 150" stroke="#3498db" stroke-width="2"/>
                                <text x="225" y="165" text-anchor="middle" font-size="10" fill="#3498db">REV</text>
                                <rect x="155" y="-30" width="80" height="30" fill="#dbeafe" stroke="#60a5fa" rx="4"/>
                                <text x="195" y="-10" text-anchor="middle" font-size="10">AD8307 #1</text>
                                <rect x="185" y="170" width="80" height="30" fill="#dbeafe" stroke="#60a5fa" rx="4"/>
                                <text x="225" y="190" text-anchor="middle" font-size="10">AD8307 #2</text>
                                <path d="M 235 -15 L 280 -15 L 280 20 L 350 20" stroke="black" stroke-width="1.5"/>
                                <path d="M 265 185 L 300 185 L 300 150 L 350 150" stroke="black" stroke-width="1.5"/>
                                <rect x="350" y="0" width="100" height="170" fill="#d1fae5" stroke="#10b981" rx="4"/>
                                <text x="400" y="85" text-anchor="middle" font-size="12">Microcontroller</text>
                                <text x="400" y="105" text-anchor="middle" font-size="10">(e.g., nRF5340)</text>
                            </g>
                        </svg>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold">How It Works</h3>
                        <ol class="list-decimal list-inside mt-2 text-sm space-y-1">
                            <li><b>Si5351</b> generates a frequency sweep (e.g., 8kHz-200MHz).</li>
                            <li>Signal enters the <b>Directional Bridge</b>.</li>
                            <li>Most power is sent to the <b>Probe</b>. A small, known fraction is sent to the Forward detector (<b>AD8307 #1</b>).</li>
                            <li>Signal reflects from the soil at the probe tip.</li>
                            <li>The reflected signal travels back to the bridge, where it is separated and sent to the Reverse detector (<b>AD8307 #2</b>).</li>
                            <li>The <b>Microcontroller</b> reads the DC voltage from both detectors and calculates the reflection coefficient (S11).</li>
                        </ol>
                    </div>
                 </div>
            </section>

            <!-- 5. How Energy Propagates in Soil -->
            <section class="info-card">
                 <h2 class="text-2xl font-bold text-slate-900 mb-4">5. How Energy Propagates in Soil</h2>
                 <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                        <h3 class="font-bold text-center mb-2">Side View - Energy Distribution</h3>
                        <svg viewBox="0 0 400 300" class="w-full h-auto border rounded">
                           <rect x="0" y="30" width="400" height="270" fill="#f5f5f5"/>
                           <text x="10" y="20" font-size="12">Soil Surface</text>
                           <ellipse cx="200" cy="30" rx="100" ry="15" fill="#f39c12" stroke="#d68910"/>
                           <rect x="190" y="30" width="20" height="250" fill="#95a5a6"/>
                           <g fill="none" stroke-width="2.5" opacity="0.7">
                                <path d="M 200 40 Q 150 80 170 140 T 200 190" stroke="#e74c3c"/>
                                <path d="M 200 40 Q 250 80 230 140 T 200 190" stroke="#e74c3c"/>
                                <path d="M 200 40 Q 120 100 150 180 T 200 240" stroke="#f39c12"/>
                                <path d="M 200 40 Q 280 100 250 180 T 200 240" stroke="#f39c12"/>
                                <path d="M 200 40 Q 80 120 120 220 T 200 280" stroke="#27ae60"/>
                                <path d="M 200 40 Q 320 120 280 220 T 200 280" stroke="#27ae60"/>
                           </g>
                        </svg>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold">Frequency Determines Depth</h3>
                        <p class="mt-2 text-sm">The sensor's ability to see into the soil depends on the frequency it uses. This is a fundamental property of electromagnetic waves in lossy materials like soil.</p>
                        <ul class="mt-4 space-y-3">
                            <li class="flex items-center gap-3">
                                <div class="w-4 h-4 rounded-full bg-red-500"></div>
                                <div><b class="text-red-600">High Frequencies (&gt;100 MHz)</b> do not penetrate far. They are sensitive to properties near the surface.</div>
                            </li>
                             <li class="flex items-center gap-3">
                                <div class="w-4 h-4 rounded-full bg-amber-500"></div>
                                <div><b class="text-amber-600">Medium Frequencies (1-10 MHz)</b> provide a good balance, measuring the root zone of many plants.</div>
                            </li>
                             <li class="flex items-center gap-3">
                                <div class="w-4 h-4 rounded-full bg-green-500"></div>
                                <div><b class="text-green-600">Low Frequencies (&lt;100 kHz)</b> penetrate deepest, revealing information about subsoil layers and groundwater.</div>
                            </li>
                        </ul>
                    </div>
                 </div>
            </section>
            
            <!-- 6. Complete Physical Construction -->
            <section class="info-card">
                <h2 class="text-2xl font-bold text-slate-900 mb-4">6. Complete Physical Construction</h2>
                <div class="grid md:grid-cols-2 gap-8 items-start">
                    <div class="w-full">
                        <h3 class="font-bold text-center mb-2">Blueprint Cross-Section</h3>
                         <!-- Copied from previous blueprint SVG -->
                        <div class="relative w-full max-w-sm mx-auto">
                            <svg viewBox="-150 -300 300 500" class="w-full h-auto">
                                <defs>
                                    <pattern id="epoxy" patternUnits="userSpaceOnUse" width="10" height="10">
                                      <path d="M-1,1 l2,-2 M0,10 l10,-10 M9,11 l2,-2" stroke="#94a3b8" stroke-width="0.5"/>
                                    </pattern>
                                    <pattern id="braid" patternUnits="userSpaceOnUse" width="8" height="8">
                                        <path d="M0 0L8 8ZM8 0L0 8Z" stroke="#9ca3af" stroke-width="1"/>
                                    </pattern>
                                </defs>
                                <rect x="-40" y="-180" width="80" height="330" fill="#f3f4f6" stroke="#9ca3af" />
                                <rect x="-40" y="-180" width="80" height="330" fill="url(#braid)" opacity="0.5"/>
                                <rect x="-40" y="-180" width="80" height="330" fill="none" stroke="#9ca3af" />
                                <rect x="-8" y="-180" width="16" height="325" fill="#e5e7eb" stroke="#6b7280" />
                                <rect x="-6" y="145" width="12" height="15" fill="#e5e7eb" stroke="#6b7280" />
                                <path d="M -15 160 C -15 170, 0 195, 0 195 C 0 195, 15 170, 15 160 Z" fill="#d1d5db" stroke="#4b5563" />
                                <rect x="-8" y="155" width="16" height="5" fill="none" stroke="#6b7280" stroke-width="0.5"/>
                                <circle cx="0" cy="135" r="3" fill="#3b82f6" />
                                <path d="M -60 -180 L -80 -200 L 80 -200 L 60 -180 Z" fill="#e5e7eb" stroke="#9ca3af"/>
                                <path d="M -80 -200 L -80 -230 L 80 -230 L 80 -200 Z" fill="#e5e7eb" stroke="#9ca3af"/>
                                <rect x="-70" y="-220" width="140" height="40" fill="url(#epoxy)" opacity="0.7"/>
                                <rect x="-40" y="-210" width="80" height="20" rx="2" fill="#dbeafe" stroke="#60a5fa" />
                                <text x="0" y="-198" text-anchor="middle" font-size="8" fill="#1e3a8a">Electronics</text>
                                <rect x="-25" y="-230" width="50" height="20" rx="2" fill="#6b7280"/>
                                <rect x="-15" y="-250" width="30" height="20" fill="#6b7280"/>
                                <path d="M 0 -250 V -280" stroke="#374151" stroke-width="8"/>
                                <circle cx="0" cy="-210" r="8" fill="#d1d5db" stroke="#9ca3af" />
                                <circle cx="0" cy="-210" r="6" fill="#f9fafb" />
                                <ellipse cx="0" cy="150" rx="90" ry="20" fill="#e5e7eb" stroke="#9ca3af"/>
                                <path d="M -90 150 C -90 138, 90 138, 90 150 C 90 162, -90 162, -90 150" fill="none" stroke="#d1d5db" />
                            </svg>
                            <!-- This is just the visual, annotations are in HTML for clarity -->
                        </div>
                    </div>
                    <div>
                        <h3 class="font-bold mb-2">Updated Bill of Materials (Field-Ready)</h3>
                        <table class="w-full text-sm">
                           <thead class="text-left bg-slate-100"><tr><th class="p-2">Component</th><th class="p-2 text-right">Cost</th></tr></thead>
                           <tbody>
                               <tr class="border-b"><td class="p-2">Electronics (Si5351, 2x AD8307, MCU)</td><td class="p-2 text-right">$40</td></tr>
                               <tr class="border-b"><td class="p-2">Fiberglass Tube (1m)</td><td class="p-2 text-right">$15</td></tr>
                               <tr class="border-b"><td class="p-2">316 Stainless Steel Rod (1m)</td><td class="p-2 text-right">$15</td></tr>
                               <tr class="border-b"><td class="p-2">Stainless Steel Braided Sleeve</td><td class="p-2 text-right">$10</td></tr>
                               <tr class="border-b"><td class="p-2">FR-4 Ground Plane Disc</td><td class="p-2 text-right">$8</td></tr>
                               <tr class="border-b"><td class="p-2">Hardened Steel Replaceable Tip</td><td class="p-2 text-right">$12</td></tr>
                               <tr class="border-b"><td class="p-2">IP68 Cable Gland & Weatherproof Box</td><td class="p-2 text-right">$15</td></tr>
                               <tr class="border-b"><td class="p-2">Potting Compound & Temp Sensor</td><td class="p-2 text-right">$10</td></tr>
                           </tbody>
                           <tfoot class="font-bold bg-slate-100"><tr><td class="p-2">Total Estimated Cost</td><td class="p-2 text-right">~$125</td></tr></tfoot>
                        </table>
                         <h3 class="font-bold mt-4 mb-2">Key Assembly Steps</h3>
                        <ol class="list-decimal list-inside text-sm space-y-1">
                            <li>Bond stainless braid securely to fiberglass tube and ground plane.</li>
                            <li>Mount center rod, ensuring it's isolated and centered.</li>
                            <li>Solder all RF connections; seal with urethane or epoxy.</li>
                            <li>Pot electronics and seal housing with IP68 cable gland.</li>
                            <li>Push probe into soil using T-handle hole until ground plane rests on the surface.</li>
                        </ol>
                    </div>
                </div>
            </section>

        </main>
        <footer class="text-center mt-12 text-xs text-slate-500">
            <p>This design guide integrates multiple feedback revisions to create a blueprint for a robust, environmentally safe, and high-performance soil sensor.</p>
        </footer>
    </div>
</body>
</html>
