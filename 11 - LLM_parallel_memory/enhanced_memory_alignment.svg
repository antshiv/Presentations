<svg id="fb1b1f24-a6b5-487d-8191-fe25def8433d" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1600 574.13"><defs><linearGradient id="b1f2aca9-e978-47e9-be98-db1d164e6d87" x1="-158.25" y1="1141" x2="-158.25" y2="1140" gradientTransform="matrix(640, 0, 0, -60, 101681, 68570)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#475569" stop-opacity="0.4"/><stop offset="1" stop-color="#334155" stop-opacity="0.4"/></linearGradient><linearGradient id="a722f490-3033-4650-a167-9cdf2b6f425b" x1="-155.76" y1="1141.5" x2="-155.76" y2="1140.5" gradientTransform="matrix(58, 0, 0, -40, 9153, 45780)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#8b5cf6"/><stop offset="1" stop-color="#7c3aed"/></linearGradient><linearGradient id="f1bc21b5-3cfb-48a4-a749-b8f9070fa97a" x1="-154.71" y1="1141.5" x2="-154.71" y2="1140.5" gradientTransform="matrix(42, 0, 0, -40, 6667, 45780)" xlink:href="#a722f490-3033-4650-a167-9cdf2b6f425b"/><linearGradient id="ae6cbded-b80e-406d-828f-737554478d0d" x1="-153.96" y1="1141.5" x2="-153.96" y2="1140.5" gradientTransform="matrix(35, 0, 0, -40, 5596, 45780)" xlink:href="#a722f490-3033-4650-a167-9cdf2b6f425b"/><linearGradient id="adced47b-08cf-432c-8d75-fcf0ee5a74eb" x1="-153.96" y1="1141.5" x2="-153.96" y2="1140.5" gradientTransform="matrix(35, 0, 0, -40, 5631, 45780)" xlink:href="#a722f490-3033-4650-a167-9cdf2b6f425b"/><linearGradient id="f8fb3af1-d9f4-4a11-921d-34c718cdfc10" x1="-155.61" y1="1141.5" x2="-155.61" y2="1140.5" gradientTransform="matrix(55, 0, 0, -40, 8846, 45780)" xlink:href="#a722f490-3033-4650-a167-9cdf2b6f425b"/><linearGradient id="efdc791c-d819-40e9-9c33-ed7b86a10c2e" x1="-154.32" y1="1141.5" x2="-154.32" y2="1140.5" gradientTransform="matrix(38, 0, 0, -40, 6198, 45780)" xlink:href="#a722f490-3033-4650-a167-9cdf2b6f425b"/><pattern id="a8c085e1-c248-49ab-a832-28157d7f7a15" data-name="conflictPattern" width="8" height="8" patternTransform="matrix(1, 0, 0, -1, 7, 1076)" patternUnits="userSpaceOnUse" viewBox="0 0 8 8"><rect width="8" height="8" style="fill:none"/><rect width="8" height="8" style="fill:#f59e0b"/><path d="M0,0,8,8M-2,6l4,4M6-2l4,4" style="stroke:#fff"/></pattern><linearGradient id="a901b80e-58f2-47dd-84c3-f1d3c7b6b4a9" x1="-158.47" y1="1141.21" x2="-157.47" y2="1141.21" gradientTransform="matrix(300, 0, 0, -35, 47621, 40160)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#f59e0b" stop-opacity="0.9"/><stop offset="1" stop-color="#d97706" stop-opacity="0.9"/></linearGradient><linearGradient id="ae016651-0d00-473c-9681-17238f1cd9bf" x1="-158.5" y1="1141.21" x2="-157.5" y2="1141.21" gradientTransform="matrix(320, 0, 0, -35, 51121, 40160)" xlink:href="#a901b80e-58f2-47dd-84c3-f1d3c7b6b4a9"/><linearGradient id="a277476f-121a-44fb-a06f-a0ec75b8f882" x1="-158.25" x2="-158.25" gradientTransform="matrix(640, 0, 0, -60, 102481, 68570)" xlink:href="#b1f2aca9-e978-47e9-be98-db1d164e6d87"/><linearGradient id="b4b0cd0b-8433-4e92-8af6-fe20ae407867" x1="-156.02" y1="1141.5" x2="-156.02" y2="1140.5" gradientTransform="matrix(64, 0, 0, -40, 10897, 45780)" xlink:href="#a722f490-3033-4650-a167-9cdf2b6f425b"/><linearGradient id="bc56dfec-15c9-4670-8f35-26a224e349f4" x1="-156.02" y1="1141.5" x2="-156.02" y2="1140.5" gradientTransform="matrix(64, 0, 0, -40, 10961, 45780)" xlink:href="#a722f490-3033-4650-a167-9cdf2b6f425b"/><linearGradient id="f92d2ec4-2f4c-4df5-aa72-6311bca134d4" x1="-156.02" y1="1141.5" x2="-156.02" y2="1140.5" gradientTransform="matrix(64, 0, 0, -40, 11025, 45780)" xlink:href="#a722f490-3033-4650-a167-9cdf2b6f425b"/><linearGradient id="b349fc26-800a-4a48-a0df-c7b351e75920" x1="-156.02" y1="1141.5" x2="-156.02" y2="1140.5" gradientTransform="matrix(64, 0, 0, -40, 11089, 45780)" xlink:href="#a722f490-3033-4650-a167-9cdf2b6f425b"/><linearGradient id="a9000d7e-26b8-41d4-b40e-6e9dde1e3c58" x1="-156.02" y1="1141.5" x2="-156.02" y2="1140.5" gradientTransform="matrix(64, 0, 0, -40, 11153, 45780)" xlink:href="#a722f490-3033-4650-a167-9cdf2b6f425b"/><linearGradient id="bc432dc3-9cb4-4c96-8a2f-fe589511a548" x1="-156.02" y1="1141.5" x2="-156.02" y2="1140.5" gradientTransform="matrix(64, 0, 0, -40, 11217, 45780)" xlink:href="#a722f490-3033-4650-a167-9cdf2b6f425b"/><linearGradient id="a8f66e78-4c6d-4c20-830a-28115213a435" x1="-157.69" y1="1141.21" x2="-156.16" y2="1141.21" gradientTransform="matrix(120, 0, 0, -35, 19801, 40160)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#10b981" stop-opacity="0.9"/><stop offset="1" stop-color="#059669" stop-opacity="0.9"/></linearGradient><linearGradient id="ac194cd9-d05a-4cc5-9842-b0b0313a0b8d" x1="-157.21" y1="1141.21" x2="-156.02" y2="1141.21" gradientTransform="matrix(120, 0, 0, -35, 19941, 40160)" xlink:href="#a8f66e78-4c6d-4c20-830a-28115213a435"/><linearGradient id="abf6d8d9-3809-4228-af39-878dd7b776c7" x1="-157.01" y1="1141.21" x2="-155.81" y2="1141.21" gradientTransform="matrix(120, 0, 0, -35, 20081, 40160)" xlink:href="#a8f66e78-4c6d-4c20-830a-28115213a435"/><linearGradient id="f8d4aa13-8993-4812-8e29-deba3d0f0700" x1="-156.76" y1="1141.21" x2="-155.76" y2="1141.21" gradientTransform="matrix(120, 0, 0, -35, 20221, 40160)" xlink:href="#a8f66e78-4c6d-4c20-830a-28115213a435"/><filter id="ff7a7146-b0fe-49d4-857e-db60863166d3" x="-20%" y="-20%" width="140%" height="140%" name="dropShadow"><feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/></filter></defs><text transform="translate(279.12 40)" style="isolation:isolate;font-size:28px;fill:#f1f5f9;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">Karpathy&apos;s Sequential Allocation vs Cache-Aligned Optimization</text><g id="a3837907-5648-4ddb-9968-62f3c10599af" data-name="karpathySection"><text transform="translate(171.96 90)" style="isolation:isolate;font-size:20px;fill:#f59e0b;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">GOOD: Karpathy&apos;s Sequential Allocation</text><rect x="80" y="110" width="640" height="60" rx="4" style="stroke:#475569;stroke-width:2px;fill:url(#b1f2aca9-e978-47e9-be98-db1d164e6d87)"/><line x1="144" y1="110" x2="144" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="208" y1="110" x2="208" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="272" y1="110" x2="272" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="336" y1="110" x2="336" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="400" y1="110" x2="400" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="464" y1="110" x2="464" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="528" y1="110" x2="528" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="592" y1="110" x2="592" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><rect x="90" y="120" width="58" height="40" rx="3" style="stroke:#8b5cf6;stroke-width:2px;fill:url(#a722f490-3033-4650-a167-9cdf2b6f425b)"/><text transform="translate(110 145)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">wte</text><rect x="148" y="120" width="42" height="40" rx="3" style="stroke:#8b5cf6;stroke-width:2px;fill:url(#f1bc21b5-3cfb-48a4-a749-b8f9070fa97a)"/><text transform="translate(160 145)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">wpe</text><rect x="190" y="120" width="35" height="40" rx="3" style="stroke:#8b5cf6;stroke-width:2px;fill:url(#ae6cbded-b80e-406d-828f-737554478d0d)"/><text transform="translate(196.2 145)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">ln1w</text><rect x="225" y="120" width="35" height="40" rx="3" style="stroke:#8b5cf6;stroke-width:2px;fill:url(#adced47b-08cf-432c-8d75-fcf0ee5a74eb)"/><text transform="translate(231.2 145)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">ln1b</text><rect x="260" y="120" width="55" height="40" rx="3" style="stroke:#8b5cf6;stroke-width:2px;fill:url(#f8fb3af1-d9f4-4a11-921d-34c718cdfc10)"/><text transform="translate(276.2 145)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">qkvw</text><rect x="315" y="120" width="38" height="40" rx="3" style="stroke:#8b5cf6;stroke-width:2px;fill:url(#efdc791c-d819-40e9-9c33-ed7b86a10c2e)"/><text transform="translate(323.2 145)" style="isolation:isolate;font-size:9px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">qkvb</text><text transform="translate(94 185)" style="isolation:isolate;font-size:10px;fill:#94a3b8;font-family:CourierNewPSMT, Courier New">Line 0</text><text transform="translate(158 185)" style="isolation:isolate;font-size:10px;fill:#94a3b8;font-family:CourierNewPSMT, Courier New">Line 1</text><text transform="translate(222 185)" style="isolation:isolate;font-size:10px;fill:#94a3b8;font-family:CourierNewPSMT, Courier New">Line 2</text><text transform="translate(286 185)" style="isolation:isolate;font-size:10px;fill:#94a3b8;font-family:CourierNewPSMT, Courier New">Line 3</text><text transform="translate(350 185)" style="isolation:isolate;font-size:10px;fill:#94a3b8;font-family:CourierNewPSMT, Courier New">Line 4</text><rect x="148" y="125" width="4" height="30" style="fill:url(#a8c085e1-c248-49ab-a832-28157d7f7a15)"/><rect x="190" y="125" width="4" height="30" style="fill:url(#a8c085e1-c248-49ab-a832-28157d7f7a15)"/><rect x="225" y="125" width="4" height="30" style="fill:url(#a8c085e1-c248-49ab-a832-28157d7f7a15)"/><rect x="260" y="125" width="4" height="30" style="fill:url(#a8c085e1-c248-49ab-a832-28157d7f7a15)"/><rect x="315" y="125" width="4" height="30" style="fill:url(#a8c085e1-c248-49ab-a832-28157d7f7a15)"/><rect x="80" y="200" width="300" height="35" rx="6" style="stroke:#f59e0b;stroke-width:2px;fill:url(#a901b80e-58f2-47dd-84c3-f1d3c7b6b4a9)"/><text transform="translate(85.98 222)" style="isolation:isolate;font-size:12px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">Parallel processing causes false sharing</text><rect x="400" y="200" width="320" height="35" rx="6" style="stroke:#f59e0b;stroke-width:2px;fill:url(#ae016651-0d00-473c-9681-17238f1cd9bf)"/><text transform="translate(426.78 222)" style="isolation:isolate;font-size:12px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">Sequential but not cache-line aligned</text></g><g id="e2087934-8cde-40c8-91ea-48f3de9a16c8" data-name="optimizedSection"><text transform="translate(965.96 90)" style="isolation:isolate;font-size:20px;fill:#10b981;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">BETTER: Cache-Aligned bump() Allocation</text><rect x="880" y="110" width="640" height="60" rx="4" style="stroke:#475569;stroke-width:2px;fill:url(#a277476f-121a-44fb-a06f-a0ec75b8f882)"/><line x1="944" y1="110" x2="944" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="1008" y1="110" x2="1008" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="1072" y1="110" x2="1072" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="1136" y1="110" x2="1136" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="1200" y1="110" x2="1200" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="1264" y1="110" x2="1264" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="1328" y1="110" x2="1328" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><line x1="1392" y1="110" x2="1392" y2="170" style="fill:none;stroke:#64748b;stroke-dasharray:2,2"/><rect x="880" y="120" width="64" height="40" rx="3" style="stroke:#8b5cf6;stroke-width:2px;fill:url(#b4b0cd0b-8433-4e92-8af6-fe20ae407867)"/><text transform="translate(903 145)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">wte</text><rect x="944" y="120" width="64" height="40" rx="3" style="stroke:#8b5cf6;stroke-width:2px;fill:url(#bc56dfec-15c9-4670-8f35-26a224e349f4)"/><text transform="translate(967 145)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">wpe</text><rect x="1008" y="120" width="64" height="40" rx="3" style="stroke:#8b5cf6;stroke-width:2px;fill:url(#f92d2ec4-2f4c-4df5-aa72-6311bca134d4)"/><text transform="translate(1028 145)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">ln1w</text><rect x="1072" y="120" width="64" height="40" rx="3" style="stroke:#8b5cf6;stroke-width:2px;fill:url(#b349fc26-800a-4a48-a0df-c7b351e75920)"/><text transform="translate(1092 145)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">ln1b</text><rect x="1136" y="120" width="64" height="40" rx="3" style="stroke:#8b5cf6;stroke-width:2px;fill:url(#a9000d7e-26b8-41d4-b40e-6e9dde1e3c58)"/><text transform="translate(1156 145)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">qkvw</text><rect x="1200" y="120" width="64" height="40" rx="3" style="stroke:#8b5cf6;stroke-width:2px;fill:url(#bc432dc3-9cb4-4c96-8a2f-fe589511a548)"/><text transform="translate(1220 145)" style="isolation:isolate;font-size:10px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">qkvb</text><text transform="translate(894 185)" style="isolation:isolate;font-size:10px;fill:#94a3b8;font-family:CourierNewPSMT, Courier New">Line 0</text><text transform="translate(958 185)" style="isolation:isolate;font-size:10px;fill:#94a3b8;font-family:CourierNewPSMT, Courier New">Line 1</text><text transform="translate(1022 185)" style="isolation:isolate;font-size:10px;fill:#94a3b8;font-family:CourierNewPSMT, Courier New">Line 2</text><text transform="translate(1086 185)" style="isolation:isolate;font-size:10px;fill:#94a3b8;font-family:CourierNewPSMT, Courier New">Line 3</text><text transform="translate(1150 185)" style="isolation:isolate;font-size:10px;fill:#94a3b8;font-family:CourierNewPSMT, Courier New">Line 4</text><text transform="translate(1214 185)" style="isolation:isolate;font-size:10px;fill:#94a3b8;font-family:CourierNewPSMT, Courier New">Line 5</text><path d="M887.2,200h165.6c5.08,0,9.2,2.69,9.2,6v23c0,3.31-4.12,6-9.2,6H887.2c-5.08,0-9.2-2.69-9.2-6V206C878,202.69,882.12,200,887.2,200Z" style="stroke:#10b981;stroke-width:2px;fill:url(#a8f66e78-4c6d-4c20-830a-28115213a435)"/><text transform="translate(883.59 222)" style="isolation:isolate;font-size:12px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">Perfect parallel scaling</text><path d="M1083.26,200h127.65c3.92,0,7.09,2.69,7.09,6v23c0,3.31-3.17,6-7.09,6H1083.26c-3.91,0-7.09-2.69-7.09-6V206C1076.17,202.69,1079.35,200,1083.26,200Z" style="stroke:#10b981;stroke-width:2px;fill:url(#ac194cd9-d05a-4cc5-9842-b0b0313a0b8d)"/><text transform="translate(1082.27 222)" style="isolation:isolate;font-size:12px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">Zero false sharing</text><path d="M1247.2,200h129.6c4,0,7.2,2.69,7.2,6v23c0,3.31-3.22,6-7.2,6H1247.2c-4,0-7.2-2.69-7.2-6V206C1240,202.69,1243.22,200,1247.2,200Z" style="stroke:#10b981;stroke-width:2px;fill:url(#abf6d8d9-3809-4228-af39-878dd7b776c7)"/><text transform="translate(1247.19 222)" style="isolation:isolate;font-size:12px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">Cache-line aligned</text><rect x="1410" y="200" width="120" height="35" rx="6" style="stroke:#10b981;stroke-width:2px;fill:url(#f8d4aa13-8993-4812-8e29-deba3d0f0700)"/><text transform="translate(1419.59 222)" style="isolation:isolate;font-size:12px;fill:#fff;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">Linear speedup</text></g><g id="b2ec6612-f39d-450d-bdcb-0e2a3fdbd7fc" data-name="performanceSection"><g style="filter:url(#ff7a7146-b0fe-49d4-857e-db60863166d3)"><rect x="80" y="260" width="640" height="100" rx="12" style="fill:#1e293b"/><rect x="80" y="260" width="640" height="100" rx="12" style="fill:none;stroke:#f59e0b;stroke-width:2px"/></g><text transform="translate(284.78 285)" style="isolation:isolate;font-size:22px;fill:#f59e0b;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">Sequential Layout Issues</text><text transform="translate(100 319)" style="isolation:isolate;font-size:17px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">• Single allocation <tspan x="204.03" y="0" style="font-family:MyriadPro-Regular, Myriad Pro">✓</tspan><tspan x="212.53" y="0" xml:space="preserve"> (Good for memory management)</tspan></text><text transform="translate(100 349.5)" style="isolation:isolate;font-size:17px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">• Sequential access <tspan x="204.03" y="0" style="font-family:MyriadPro-Regular, Myriad Pro">✓</tspan><tspan x="212.53" y="0" xml:space="preserve"> (Good for single-threaded performance)</tspan></text><text transform="translate(100 380)" style="isolation:isolate;font-size:17px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">• No cache alignment <tspan x="214.23" y="0" style="font-family:MyriadPro-Regular, Myriad Pro">✗</tspan><tspan x="222.73" y="0" xml:space="preserve"> (Parallel processing suffers)</tspan></text><g style="filter:url(#ff7a7146-b0fe-49d4-857e-db60863166d3)"><rect x="880" y="260" width="640" height="100" rx="12" style="fill:#1e293b"/><rect x="880" y="260" width="640" height="100" rx="12" style="fill:none;stroke:#10b981;stroke-width:2px"/></g><text transform="translate(1094.38 285)" style="isolation:isolate;font-size:22px;fill:#10b981;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">Cache-Aligned Benefits</text><text transform="translate(900 319)" style="font-size:17px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">• Single allocation <tspan x="204.03" y="0" style="font-family:MyriadPro-Regular, Myriad Pro">✓</tspan><tspan x="212.53" y="0" xml:space="preserve"> (Inherits Karpathy&apos;s benefits)</tspan></text><text transform="translate(900 351.1)" style="font-size:17px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">• Sequential access <tspan x="204.03" y="0" style="font-family:MyriadPro-Regular, Myriad Pro">✓</tspan><tspan x="212.53" y="0" xml:space="preserve"> (Maintains single-threaded performance)</tspan></text><text transform="translate(900 383.2)" style="font-size:17px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">• Perfect alignment <tspan x="204.03" y="0" style="font-family:MyriadPro-Regular, Myriad Pro">✓</tspan><tspan x="212.53" y="0" xml:space="preserve"> (Unlocks parallel performance)</tspan></text></g><g id="b3d23daf-d80a-42f8-a96d-9a894c323c4f" data-name="codeComparison"><g style="filter:url(#ff7a7146-b0fe-49d4-857e-db60863166d3)"><path d="M92,390H748c6.63,0,12,5.93,12,13.24v150c0,7.31-5.37,13.24-12,13.24H92c-6.63,0-12-5.93-12-13.24v-150C80,395.93,85.37,390,92,390Z" style="fill:#1e293b"/><path d="M92,390H748c6.63,0,12,5.93,12,13.24v150c0,7.31-5.37,13.24-12,13.24H92c-6.63,0-12-5.93-12-13.24v-150C80,395.93,85.37,390,92,390Z" style="fill:none;stroke:#f59e0b;stroke-width:2px"/></g><text transform="translate(295.18 420)" style="font-size:22px;fill:#f59e0b;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">Karpathy&apos;s Approach (Good)</text><text transform="translate(100 445)" style="isolation:isolate;font-size:15px;fill:#94a3b8;font-family:CourierNewPSMT, Courier New">// Single allocation, sequential layout</text><text transform="translate(100 465)" style="isolation:isolate;font-size:15px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">float* params_memory = malloc(num_parameters * sizeof(float));</text><text transform="translate(100 485)" style="isolation:isolate;font-size:15px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">float* iterator = params_memory;</text><text transform="translate(100 505)" style="isolation:isolate;font-size:15px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">params-&gt;wte = iterator; iterator += wte_size;</text><text transform="translate(100 525)" style="isolation:isolate;font-size:15px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">params-&gt;wpe = iterator; iterator += wpe_size;</text><text transform="translate(100 550)" style="isolation:isolate;font-size:14px;fill:#64748b;font-family:CourierNewPSMT, Courier New">// Result: Sequential but not cache-aligned</text><g style="filter:url(#ff7a7146-b0fe-49d4-857e-db60863166d3)"><path d="M896.28,389.8h656c6.63,0,12,5.93,12,13.24V553c0,7.31-5.37,13.23-12,13.23h-656c-6.63,0-12-5.92-12-13.23V403C884.28,395.73,889.65,389.8,896.28,389.8Z" style="fill:#1e293b"/><path d="M896.28,389.8h656c6.63,0,12,5.93,12,13.24V553c0,7.31-5.37,13.23-12,13.23h-656c-6.63,0-12-5.92-12-13.23V403C884.28,395.73,889.65,389.8,896.28,389.8Z" style="fill:none;stroke:#10b981;stroke-width:2px"/></g><text transform="translate(1075.46 419.8)" style="font-size:22px;fill:#10b981;font-family:CourierNewPS-BoldMT, Courier New;font-weight:700">Cache-Aligned Approach (Better)</text><text transform="translate(904.28 444.8)" style="font-size:15px;fill:#94a3b8;font-family:CourierNewPSMT, Courier New">// Single allocation + perfect 64-byte alignment</text><text transform="translate(904.28 464.8)" style="font-size:15px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">float* params_memory = huge_alloc(total_size);</text><text transform="translate(904.28 504.8)" style="font-size:15px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">wte_offset = bump(&amp;off, wte_size, CACHE_ALIGN);</text><text transform="translate(904.28 524.8)" style="font-size:15px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">wpe_offset = bump(&amp;off, wpe_size, CACHE_ALIGN);</text><text transform="translate(904.28 552.43)" style="font-size:14px;fill:#64748b;font-family:CourierNewPSMT, Courier New">// Result: Sequential + cache-aligned + parallel-ready</text><text transform="translate(905.96 485)" style="font-size:15px;fill:#f1f5f9;font-family:CourierNewPSMT, Courier New">size_t off = 0;</text></g><g id="e9f01545-5201-4b68-b48f-ddde818b8b6f" data-name="animationElements" style="opacity:0"><g id="a9bbfdac-4b80-43fe-a553-ce472b3baee7" data-name="karpathyBouncing"><circle id="abbf3a31-27c9-4f3a-92ff-4e27bb1ae557" data-name="kBounce1" cx="190" cy="140" r="8" style="fill:#f59e0b;isolation:isolate;opacity:0.800000011920929"/><circle id="bb2fb994-e34b-4c53-acbd-e752b08b3d1d" data-name="kBounce2" cx="280" cy="140" r="8" style="fill:#f59e0b;isolation:isolate;opacity:0.800000011920929"/><circle id="f70f53a1-fdeb-47ad-8fd2-22c37a6d490f" data-name="kBounce3" cx="380" cy="140" r="8" style="fill:#f59e0b;isolation:isolate;opacity:0.800000011920929"/></g><g id="bca4c546-fe15-4ae4-8176-485a93afb337" data-name="optimizedSuccess"><circle id="ab1bdce3-e96d-4884-aac2-b58203c040cd" data-name="oSuccess1" cx="912" cy="140" r="8" style="fill:#10b981;isolation:isolate;opacity:0.8999999761581421"/><circle id="f28f2a61-55ec-46c5-9ab6-05c1bcb692ff" data-name="oSuccess2" cx="976" cy="140" r="8" style="fill:#10b981;isolation:isolate;opacity:0.8999999761581421"/><circle id="ba79701a-b4fa-4cf6-a184-f144250a1612" data-name="oSuccess3" cx="1040" cy="140" r="8" style="fill:#10b981;isolation:isolate;opacity:0.8999999761581421"/><circle id="a2769292-5e25-4cea-bad5-231e7eee7339" data-name="oSuccess4" cx="1104" cy="140" r="8" style="fill:#10b981;isolation:isolate;opacity:0.8999999761581421"/></g></g></svg>